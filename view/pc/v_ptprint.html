<!DOCTYPE html>
<html>
<head>
    <title>打印瓶贴</title>
    <script src="/static/dist/js/lib/jquery.min.js"></script>
    <script src="/static/dist/js/lib/jquery.qrcode.min.js"></script>
</head>
<style type="text/css">
    .imgx {
        width: 60px;
        margin-left: 230px;
        margin-top: 16px;
    }
    .qrDiv{
        width: 60px;
        margin-left: 230px;
        margin-top: 16px;
        display: inline-block;
    }

    body {
        margin: 0px
    }

    .warp {
        display: inline-block;
        /*padding-left:10px;*/
        padding-top: 10px;
        vertical-align: top;
        position: absolute;
        left: 50px;
    }

    .warp p {
        margin: 0;
        font-size: 16px;
    }

    .warp2 {
        width: 178px;
        padding-top: 4px;
    }

    .imgx.type2 {
        margin-top: 6px;
    }
    .qrDiv.type2{
        margin-top: 6px;
    }
    .warp span.right {
        float: right;
    }

    .line {
        border-top: 1px solid #000;
        background: #000;
        width: 300px;
    }

    .cont {
        width: 300px;
        height: 200px;
        padding: 0 10px;
        box-sizing: border-box;
        font-size: 12px;
    }

    .cont p {
        margin: 0;
    }

    .unit {
        float: right;
        font-size: 16px;
    }

    .cont2 {
        padding-left: 40px
    }
</style>
<body>
<div>
    <div class="cont2">
        <div class="warp">
            <p>床号：</p>
            <p>姓名：</p>
            <p>用法：静滴</p>
        </div>
        <img class="imgx"
             src="https://qr.api.cli.im/qr?data=124&level=H&transparent=false&bgcolor=%23ffffff&forecolor=%23000000&blockpixel=12&marginblock=1&logourl=&size=280&kid=cliim&key=26662b2f080feeb2da43226211b84364">
        <div class="line">
        </div>
        <div class="cont">
            <p><span class="unit"></span></p>
            <p></p>
            <p><span class="unit"></span></p>
            <p></p>
            <p><span class="unit"></span></p>
            <p></p>
            <p><span class="unit"></span></p>
            <p></p>
            <p><span class="unit"></span></p>
            <p></p>
            <p><span class="unit"></span></p>
            <p></p>
        </div>
        <div class="line">
        </div>
        <div class="warp warp2">
            <p>嘱托</p>
            <p></p>
            <p>频度 <span class="right">序号 </span></p>
        </div>
        <img class="imgx type2"
             src="https://qr.api.cli.im/qr?data=124&level=H&transparent=false&bgcolor=%23ffffff&forecolor=%23000000&blockpixel=12&marginblock=1&logourl=&size=280&kid=cliim&key=26662b2f080feeb2da43226211b84364">
    </div>
</div>

<script src="/static/dist/js/lib/jquery.qrcode.min.js"></script>

<script type="text/javascript">
    $(function () {
        var datas = {{.PrintInfo}};//数据
        var time = {{.Now}};
        loadData(datas,time);
    });

    function loadData(datas,time) {
        var len = datas.length;
        if (len == 0)
            return;
        console.log(datas);
        var html = "";
        for (var i = 0; i < len; i++) {
            var times = datas[i].Times;
            for (var j=0;j < times;j++){
                html+='<div>\n' +
                        '    <div class="cont2">' +
                        '        <div class="warp">' +
                        '            <p>床号：'+datas[i].Bed+'</p>' +
                        '            <p>姓名：'+datas[i].PatientName+'</p>' +
                        '            <p>用法：静滴</p>' +
                        '        </div>\n' +
                        '<div class="qrDiv" data-madid='+datas[i].Madid+'></div>'+
                        // '        <img class="imgx" src="https://qr.api.cli.im/qr?data=124&level=H&transparent=false&bgcolor=%23ffffff&forecolor=%23000000&blockpixel=12&marginblock=1&logourl=&size=280&kid=cliim&key=26662b2f080feeb2da43226211b84364">' +
                        '        <div class="line">' +
                        '        </div>\n' +
                        '        <div class="cont">' +
                        '            <p>'+datas[i].Content+'<span class="unit">'+datas[i].Dosage+'</span></p>' +
                        '            <p >500毫升*1袋</p>' +
                        '        </div>' +
                        '        <div class="line">' +
                        '        </div>' +
                        '        <div class="warp warp2">' +
                        '            <p>嘱托</p>' +
                        '            <p>'+time+'</p>' +
                        '            <p>频度'+datas[i].PcInfo+' <span class="right">序号 '+(j+1)+'</span></p>' +
                        '        </div>' +
                        '<div class="qrDiv type2" data-madid='+datas[i].Madid +'></div>'+
                        // '        <img class="imgx type2"' +
                        // '             src="https://qr.api.cli.im/qr?data=124&level=H&transparent=false&bgcolor=%23ffffff&forecolor=%23000000&blockpixel=12&marginblock=1&logourl=&size=280&kid=cliim&key=26662b2f080feeb2da43226211b84364">\n' +
                        '    </div>' +
                        '</div>';
            }
        }
        $('body').html(html)
        $('.qrDiv').each(function(i,el){
            var madid = $(el).data("madid").toString()
            console.log(madid)
            $(el).qrcode({
                width: 60,
                height: 60,
                text:"PT-"+madid
            })
        })
    }

</script>
</body>
</html>